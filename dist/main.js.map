{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 23489288ad23c3912cb7","webpack:///external \"react\"","webpack:///external {\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"_\",\"root\":\"_\"}","webpack:///./src/Common.js","webpack:///./src/BaseEntity.js","webpack:///./src/AbstractInstanceFactory.js","webpack:///./src/WidgetFactories.js","webpack:///./src/defaults/DefaultLinkWidget.js","webpack:///./src/defaults/DefaultNodeWidget.js","webpack:///./src/DiagramModel.js","webpack:///./src/Toolkit.js","webpack:///./src/defaults/DefaultPortLabelWidget.js","webpack:///./src/widgets/LinkLayerWidget.js","webpack:///./src/widgets/LinkWidget.js","webpack:///./src/widgets/NodeLayerWidget.js","webpack:///./src/widgets/NodeWidget.js","webpack:///./src/widgets/PortWidget.js","webpack:///./src/DiagramEngine.js","webpack:///./src/LinkInstanceFactory.js","webpack:///./src/defaults/DefaultLinkFactory.js","webpack:///./src/defaults/DefaultNodeFactory.js","webpack:///./src/defaults/DefaultNodeModel.js","webpack:///./src/defaults/DefaultPortModel.js","webpack:///./src/widgets/DiagramWidget.js","webpack:///./src/main.js"],"names":["BaseModel","selected","ob","_class","constructor","name","id","itterateListeners","listener","selectionChanged","entityRemoved","PointModel","link","points","x","y","removePoint","LinkModel","linkType","extras","sourcePort","targetPort","type","p","point","deSerialize","source","getParent","target","serialize","removeLink","index","getPointIndex","length","indexOf","i","port","addLink","pointModel","splice","PortModel","links","parentNode","node","getID","NodeModel","nodeType","ports","_","getLinks","remove","setParentNode","BaseEntity","listeners","Toolkit","UID","data","cb","uid","AbstractInstanceFactory","className","WidgetFactory","NodeWidgetFactory","diagramEngine","React","createElement","LinkWidgetFactory","DefaultLinkWidget","props","state","pointIndex","g","key","circle","isSelected","cx","cy","r","opacity","onMouseLeave","setState","onMouseEnter","extraProps","Bottom","path","strokeWidth","width","stroke","color","Top","strokeLinecap","strokeOpacity","onContextMenu","event","preventDefault","paths","margin","Math","abs","pointLeft","pointRight","push","generateLink","onMouseDown","shiftKey","getRelativeMousePoint","setSelected","forceUpdate","addPoint","pointAdded","d","generatePoint","ds","smooth","map","defaultProps","engine","div","DefaultNodeWidget","style","background","onClick","onRemove","bind","getInPorts","model","getOutPorts","DiagramModel","nodes","offsetX","offsetY","zoom","rendered","object","nodeOb","getInstanceFactory","getInstance","portOb","addPort","addNode","linkOb","setTargetPort","getNode","getPortFromID","setSourcePort","ignore","getSelectedItems","element","items","concat","controlsUpdated","addListener","linksUpdated","removeNode","nodesUpdated","replace","c","random","v","toString","DefaultPortLabel","label","in","LinkLayerWidget","diagramModel","getDiagramModel","svg","transform","getZoomLevel","getOffsetX","getOffsetY","height","updateLocation","getPortCenter","ex","console","log","generatedLink","generateWidgetForLink","getType","LinkWidget","canEntityRepaint","children","NodeLayerWidget","updateDiagram","getNodes","generateWidgetForNode","NodeWidget","top","left","PortWidget","DiagramEngine","nodeFactories","linkFactories","instanceFactories","canvas","paintableWidgets","entities","forEach","entity","getPorts","getLink","baseModel","undefined","factory","getName","nodeFactoriesUpdated","linkFactoriesUpdated","linkFactory","getFactoryForLink","generateReactWidget","nodeFactory","getFactoryForNode","getRelativePoint","pageX","pageY","canvasRect","getBoundingClientRect","selector","querySelector","sourceElement","getNodePortElement","sourceRect","rel","offsetWidth","offsetHeight","LinkInstanceFactory","DefaultLinkFactory","DefaultNodeFactory","DefaultNodeInstanceFactory","DefaultNodeModel","portModel","DefaultPortInstanceFactory","DefaultPortModel","isInput","BaseAction","mouseX","mouseY","ms","Date","getTime","SelectingAction","mouseX2","mouseY2","z","MoveCanvasAction","initialOffsetX","initialOffsetY","MoveItemsAction","moved","enableRepaintEntities","selectionModels","item","initialX","initialY","DiagramWidget","action","renderedNodes","windowListener","setCanvas","window","removeEventListener","nextProps","refs","setForceUpdate","addEventListener","keyCode","focus","closest","nodeElement","getAttribute","getPort","getPointModel","ref","onWheel","stopPropagation","setZoomLevel","deltaY","onMouseMove","relative","containsElement","allSelected","setOffset","clearRepaintEntities","getMouseElement","clearSelection","getFirstPoint","getLastPoint","onMouseUp"],"mappings":"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","file":"main.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"), require(\"lodash\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\", \"_\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"react-js-diagrams\"] = factory(require(\"react\"), require(\"lodash\"));\n\telse\n\t\troot[\"react-js-diagrams\"] = factory(root[\"react\"], root[\"_\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 23);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 23489288ad23c3912cb7","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = 0\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"_\",\"root\":\"_\"}\n// module id = 1\n// module chunks = 0","import { BaseEntity } from \"./BaseEntity\";\nimport * as _ from \"lodash\";\n\n/**\n * @author Dylan Vorster\n */\nexport class BaseModel extends BaseEntity {\n\tconstructor(){\n\t\tsuper();\n\t\tthis.selected = false;\n\t}\n\n\tdeSerialize(ob){\n\t\tsuper.deSerialize(ob);\n\t\tthis.selected = ob.selected;\n\t}\n\n\tserialize(){\n\t\treturn _.merge(super.serialize(),{\n\t\t\t_class: this.constructor.name,\n\t\t\tselected: this.selected\n\t\t});\n\t}\n\n\tgetID() {\n\t\treturn this.id;\n\t}\n\n\tisSelected() {\n\t\treturn this.selected;\n\t}\n\n\tsetSelected(selected){\n\t\tthis.selected = selected;\n\n\t\tthis.itterateListeners(listener => {\n\t\t\tif(listener.selectionChanged) {\n\t\t\t\tlistener.selectionChanged();\n\t\t\t}\n\t\t});\n\t}\n\n\tremove(){\n\t\tthis.itterateListeners(listener => {\n\t\t\tif(listener.entityRemoved) {\n\t\t\t\tlistener.entityRemoved();\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport class PointModel extends BaseModel{\n\tconstructor(link, points) {\n\t\tsuper();\n\t\tthis.x = points.x;\n\t\tthis.y = points.y;\n\t\tthis.link = link;\n\t}\n\n\tdeSerialize(ob){\n\t\tsuper.deSerialize(ob);\n\t\tthis.x = ob.x;\n\t\tthis.y = ob.y;\n\t}\n\n\tserialize() {\n\t\treturn _.merge(super.serialize(),{\n\t\t\tx: this.x,\n\t\t\ty: this.y\n\t\t});\n\t}\n\n\tremove() {\n\t\tsuper.remove();\n\n\t\t//clear references\n\t\tif (this.link){\n\t\t\tthis.link.removePoint(this);\n\t\t}\n\t}\n\n\tupdateLocation(points) {\n\t\tthis.x = points.x;\n\t\tthis.y = points.y;\n\t}\n\n\tgetX() {\n\t\treturn this.x;\n\t}\n\n\tgetY() {\n\t\treturn this.y;\n\t}\n\n\tgetLink() {\n\t\treturn this.link;\n\t}\n}\n\nexport class LinkModel extends BaseModel{\n\tconstructor(){\n\t\tsuper();\n\t\tthis.linkType = 'default';\n\t\tthis.points = [\n\t\t\tnew PointModel(this,{x: 0,y: 0}),\n\t\t\tnew PointModel(this,{x: 0,y: 0}),\n\t\t];\n\t\tthis.extras = {};\n\t\tthis.sourcePort = null;\n\t\tthis.targetPort = null;\n\t}\n\n\tdeSerialize(ob){\n\t\tsuper.deSerialize(ob);\n\t\tthis.linkType = ob.type;\n\t\tthis.points = _.map(ob.points, point => {\n\t\t\tvar p = new PointModel(this, {x: point.x,y:point.y});\n\t\t\tp.deSerialize(point);\n\t\t\treturn p;\n\t\t})\n\t}\n\n\tserialize(){\n\t\treturn _.merge(super.serialize(),{\n\t\t\ttype: this.linkType,\n\t\t\tsource: this.sourcePort ? this.sourcePort.getParent().id:null,\n\t\t\tsourcePort: this.sourcePort ? this.sourcePort.id:null,\n\t\t\ttarget: this.targetPort ? this.targetPort.getParent().id:null,\n\t\t\ttargetPort: this.targetPort ? this.targetPort.id:null,\n\t\t\tpoints: _.map(this.points,(point) => {\n\t\t\t\treturn point.serialize();\n\t\t\t}),\n\t\t\textras: this.extras\n\t\t});\n\t}\n\n\tremove() {\n\t\tsuper.remove();\n\t\tif (this.sourcePort){\n\t\t\tthis.sourcePort.removeLink(this);\n\t\t}\n\t\tif (this.targetPort){\n\t\t\tthis.targetPort.removeLink(this);\n\t\t}\n\t}\n\n\tisLastPoint(point) {\n\t\tvar index = this.getPointIndex(point);\n\t\treturn index === this.points.length-1;\n\t}\n\n\tgetPointIndex(point) {\n\t\treturn this.points.indexOf(point);\n\t}\n\n\tgetPointModel(id) {\n\t\tfor (var i = 0; i < this.points.length;i++){\n\t\t\tif (this.points[i].id === id){\n\t\t\t\treturn this.points[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetFirstPoint() {\n\t\treturn this.points[0];\n\t}\n\n\tgetLastPoint() {\n\t\treturn this.points[this.points.length-1];\n\t}\n\n\tsetSourcePort(port) {\n\t\tport.addLink(this);\n\t\tthis.sourcePort = port;\n\t}\n\n\tgetSourcePort() {\n\t\treturn this.sourcePort;\n\t}\n\n\tgetTargetPort() {\n\t\treturn this.targetPort;\n\t}\n\n\tsetTargetPort(port) {\n\t\tport.addLink(this);\n\t\tthis.targetPort = port;\n\t}\n\n\tgetPoints() {\n\t\treturn this.points;\n\t}\n\n\tsetPoints(points) {\n\t\tthis.points = points;\n\t}\n\n\tremovePoint(pointModel) {\n\t\tthis.points.splice(this.getPointIndex(pointModel),1);\n\t}\n\n\taddPoint(pointModel, index = 1) {\n\t\tthis.points.splice(index,0,pointModel);\n\t}\n\n\tgetType() {\n\t\treturn this.linkType;\n\t}\n}\n\nexport class PortModel extends BaseModel {\n\tconstructor(name) {\n\t\tsuper();\n\t\tthis.name = name;\n\t\tthis.links = {};\n\t\tthis.parentNode = null;\n\t}\n\n\tdeSerialize(ob){\n\t\tsuper.deSerialize(ob);\n\t\tthis.name = ob.name;\n\t}\n\n\tserialize(){\n\t\treturn _.merge(super.serialize(),{\n\t\t\tname: this.name,\n\t\t\tparentNode: this.parentNode.id,\n\t\t\tlinks: _.map(this.links,(link) => {\n\t\t\t\treturn link.id;\n\t\t\t})\n\t\t});\n\t}\n\n\tgetName() {\n\t\treturn this.name;\n\t}\n\n\tgetParent() {\n\t\treturn this.parentNode;\n\t}\n\n\tsetParentNode(node) {\n\t\tthis.parentNode = node;\n\t}\n\n\tremoveLink(link) {\n\t\tdelete this.links[link.getID()];\n\t}\n\n\taddLink(link) {\n\t\tthis.links[link.getID()] = link;\n\t}\n\n\tgetLinks() {\n\t\treturn this.links;\n\t}\n}\n\nexport class NodeModel extends BaseModel {\n\tconstructor(nodeType = 'default') {\n\t\tsuper();\n\t\tthis.nodeType = nodeType;\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t\tthis.extras = {};\n\t\tthis.ports = {};\n\t}\n\n\tdeSerialize(ob) {\n\t\tsuper.deSerialize(ob);\n\t\tthis.nodeType = ob.type;\n\t\tthis.x = ob.x;\n\t\tthis.y = ob.y;\n\t\tthis.extras = ob.extras;\n\t}\n\n\tserialize() {\n\t\treturn _.merge(super.serialize(),{\n\t\t\ttype: this.nodeType,\n\t\t\tx: this.x,\n\t\t\ty: this.y,\n\t\t\textras: this.extras,\n\t\t\tports: _.map(this.ports, (port) => port.serialize())\n\t\t});\n\t}\n\n\tremove() {\n\t\tsuper.remove();\n\t\tfor (var i in this.ports){\n\t\t\t_.forEach(this.ports[i].getLinks(),(link) => {\n\t\t\t\tlink.remove();\n\t\t\t});\n\t\t}\n\t}\n\n\tgetPortFromID(id) {\n\t\tfor (var i in this.ports){\n\t\t\tif (this.ports[i].id === id){\n\t\t\t\treturn this.ports[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetPort(name) {\n\t\treturn this.ports[name];\n\t}\n\n\tgetPorts() {\n\t\treturn this.ports;\n\t}\n\n\tremovePort(port) {\n\t\t//clear the parent node reference\n\t\tif(this.ports[port.name]){\n\t\t\tthis.ports[port.name].setParentNode(null);\n\t\t\tdelete this.ports[port.name];\n\t\t}\n\t}\n\n\taddPort(port) {\n\t\tport.setParentNode(this);\n\t\tthis.ports[port.name] = port;\n\t\treturn port;\n\t}\n\n\tgetType() {\n\t\treturn this.nodeType;\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Common.js","import {Toolkit} from \"./Toolkit\";\n\nexport class BaseEntity {\n\tconstructor() {\n\t\tthis.listeners = {};\n\t\tthis.id = Toolkit.UID();\n\t}\n\n\tgetID() {\n\t\treturn this.id;\n\t}\n\n\tclearListeners(){\n\t\tthis.listeners = {};\n\t}\n\n\tdeSerialize(data){\n\t\tthis.id = data.id;\n\t}\n\n\tserialize(){\n\t\treturn {\n\t\t\tid: this.id,\n\t\t};\n\t}\n\n\titterateListeners(cb) {\n\t\tfor (var i in this.listeners){\n\t\t\tcb(this.listeners[i]);\n\t\t}\n\t}\n\n\tremoveListener(listener){\n\t\tif (this.listeners[listener]){\n\t\t\tdelete this.listeners[listener];\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\taddListener(listener) {\n\t\tvar uid = Toolkit.UID();\n\t\tthis.listeners[uid] = listener;\n\t\treturn uid;\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/BaseEntity.js","import { BaseEntity } from \"./BaseEntity\";\n/**\n * @author Dylan Vorster\n */\nexport class AbstractInstanceFactory extends BaseEntity {\n\tconstructor(className) {\n\t  super(className);\n\t\tthis.className = className;\n\t}\n\t\n\tgetName(){\n\t\treturn this.className;\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/AbstractInstanceFactory.js","import React from 'react';\nimport { DefaultNodeWidget } from './defaults/DefaultNodeWidget';\nimport { DefaultLinkWidget } from './defaults/DefaultLinkWidget';\n\nexport class WidgetFactory {\n\tconstructor(name) {\n\t\tthis.type = name;\n\t}\n\n\tgetType() {\n\t\treturn this.type;\n\t}\n}\n\nexport class NodeWidgetFactory extends WidgetFactory {\n\tgenerateReactWidget(diagramEngine, node) {\n\t  return React.createElement(DefaultNodeWidget, {\n\t\t\tnode,\n\t\t\tdiagramEngine\n\t\t});\n\t}\n}\n\nexport class LinkWidgetFactory extends WidgetFactory {\n\tgenerateReactWidget(diagramEngine, link) {\n\t  return React.createElement(DefaultLinkWidget, {\n\t\t\tlink,\n\t\t\tdiagramEngine\n\t\t});\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/WidgetFactories.js","import * as React from \"react\";\nimport {PointModel} from \"../Common\";\nimport * as _ from \"lodash\";\n\n/**\n * @author Dylan Vorster\n */\nexport class DefaultLinkWidget extends React.Component {\n\n\tstatic defaultProps = {\n\t\tcolor: 'black',\n\t\twidth: 3,\n\t\tlink:null,\n\t\tengine: null,\n\t\tsmooth: false,\n\t\tdiagramEngine: null\n\t};\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tselected: false\n\t\t};\n\t}\n\n\tgeneratePoint(pointIndex) {\n\t\treturn React.DOM.g({key:'point-'+this.props.link.points[pointIndex].id},\n\t\t\tReact.DOM.circle({\n\t\t\t\tclassName: 'point pointui' + (this.props.link.points[pointIndex].isSelected()?' selected':''),\n\t\t\t\tcx:this.props.link.points[pointIndex].x,\n\t\t\t\tcy:this.props.link.points[pointIndex].y,\n\t\t\t\tr:5,\n\t\t\t}),\n\t\t\tReact.DOM.circle({\n\t\t\t\tclassName:'point',\n\t\t\t\t'data-linkid':this.props.link.id,\n\t\t\t\t'data-id':this.props.link.points[pointIndex].id,\n\t\t\t\tcx: this.props.link.points[pointIndex].x,\n\t\t\t\tcy:this.props.link.points[pointIndex].y,\n\t\t\t\tr:15,\n\t\t\t\topacity: 0,\n\t\t\t\tonMouseLeave:() => {\n\t\t\t\t\tthis.setState({selected: false});\n\t//\t\t\t\tthis.props.link.setSelected(false);\n\t\t\t\t},\n\t\t\t\tonMouseEnter:() => {\n\t\t\t\t\tthis.setState({selected: true});\n\t//\t\t\t\tthis.props.link.setSelected(true);\n\t\t\t\t},\n\t\t\t})\n\t\t);\n\t}\n\n\tgenerateLink(extraProps) {\n\t\tvar Bottom = React.DOM.path(_.merge({\n\t\t\tclassName: (this.state.selected || this.props.link.isSelected())?'selected':'',\n\t\t\tstrokeWidth:this.props.width,\n\t\t\tstroke: this.props.color\n\t\t},extraProps));\n\n\t\tvar Top = React.DOM.path(_.merge({\n\t\t\tstrokeLinecap: 'round',\n\t\t\tonMouseLeave:() => {\n\t\t\t\tthis.setState({selected: false});\n\t\t\t},\n\t\t\tonMouseEnter:() => {\n\t\t\t\tthis.setState({selected: true});\n\t\t\t},\n\t\t\t'data-linkid': this.props.link.getID(),\n\t\t\tstroke: this.props.color,\n\t\t\tstrokeOpacity:this.state.selected?0.1:0 ,\n\t\t\tstrokeWidth: 20,\n\t\t\tonContextMenu: (event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis.props.link.remove();\n\t\t\t},\n\t\t},extraProps));\n\n\t\treturn React.DOM.g({key:'link-' + extraProps.id},\n\t\t\tBottom,Top\n\t\t);\n\t}\n\n\trender() {\n\t\t//ensure id is present for all points on the path\n\t\tvar points = this.props.link.points;\n\t\tvar paths = [];\n\n        //draw the smoothing\n\t\tif(points.length === 2){\n\n            //if the points are too close, just draw a straight line\n\t\t\tvar margin = 50;\n\t\t\tif(Math.abs(points[0].x-points[1].x) < 50){\n\t\t\t\tmargin = 5;\n\t\t\t}\n\n            var pointLeft = points[0];\n            var pointRight = points[1];\n\n            //some defensive programming to make sure the smoothing is\n            //always in the right direction\n            if(pointLeft.x > pointRight.x){\n                pointLeft = points[1];\n                pointRight = points[0];\n            }\n\n\t\t\tpaths.push(this.generateLink({\n\t\t\t\tid: 0,\n\t\t\t\tonMouseDown: (event) => {\n\t\t\t\t\tif (!event.shiftKey){\n\t\t\t\t\t\tvar point = new PointModel(this.props.link,this.props.diagramEngine.getRelativeMousePoint(event));\n\t\t\t\t\t\tpoint.setSelected(true);\n\t\t\t\t\t\tthis.forceUpdate();\n\t\t\t\t\t\tthis.props.link.addPoint(point,1);\n\t\t\t\t\t\tthis.props.pointAdded(point,event);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\td:\n\t\t\t\t\t \" M\"+pointLeft.x+\" \"+pointLeft.y\n\t\t\t\t\t+\" C\"+(pointLeft.x+margin)+\" \"+pointLeft.y\n\t\t\t\t\t+\" \" +(pointRight.x-margin)+\" \"+pointRight.y\n\t\t\t\t\t+\" \" +pointRight.x+\" \"+pointRight.y\n\t\t\t}));\n\t\t\tif (this.props.link.targetPort === null){\n\t\t\t\tpaths.push(this.generatePoint(1));\n\t\t\t}\n\t\t}\n\n        //draw the multiple anchors and complex line instead\n        else{\n\t\t\tvar ds = [];\n\t\t\tif(this.props.smooth){\n\t\t\t\tds.push(\" M\"+points[0].x+\" \"+points[0].y+\" C \"+(points[0].x+50)+\" \"+points[0].y+\" \"+points[1].x+\" \"+points[1].y+\" \"+points[1].x+\" \"+points[1].y);\n\t\t\t\tfor(var i = 1;i < points.length-2;i++){\n\t\t\t\t\tds.push(\" M \"+points[i].x+\" \"+points[i].y+\" L \"+points[i+1].x+\" \"+points[i+1].y);\n\t\t\t\t}\n\t\t\t\tds.push(\" M\"+points[i].x+\" \"+points[i].y+\" C \"+points[i].x+\" \"+points[i].y+\" \"+(points[i+1].x-50)+\" \"+points[i+1].y+\" \"+points[i+1].x+\" \"+points[i+1].y);\n\t\t\t}else{\n\t\t\t\tvar ds = [];\n\t\t\t\tfor(var i = 0;i < points.length-1;i++){\n\t\t\t\t\tds.push(\" M \"+points[i].x+\" \"+points[i].y+\" L \"+points[i+1].x+\" \"+points[i+1].y);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tpaths = ds.map((data,index) => {\n\t\t\t\treturn this.generateLink({\n\t\t\t\t\tid:index,\n\t\t\t\t\t'data-linkid':this.props.link.id,\n\t\t\t\t\t'data-point':index,\n\t\t\t\t\tonMouseDown: (event) => {\n\t\t\t\t\t\tif (!event.shiftKey){\n\t\t\t\t\t\t\tvar point = new PointModel(this.props.link,this.props.diagramEngine.getRelativeMousePoint(event));\n\t\t\t\t\t\t\tpoint.setSelected(true);\n\t\t\t\t\t\t\tthis.forceUpdate();\n\t\t\t\t\t\t\tthis.props.link.addPoint(point,index+1);\n\t\t\t\t\t\t\tthis.props.pointAdded(point,event);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\td:data\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t//render the circles\n\t\t\tfor(var i = 1;i < points.length-1;i++){\n\t\t\t\tpaths.push(this.generatePoint(i));\n\t\t\t}\n\n\t\t\tif (this.props.link.targetPort === null){\n\t\t\t\tpaths.push(this.generatePoint(points.length-1));\n\t\t\t}\n\t\t}\n\n\t\treturn (\n\t\t\tReact.DOM.g(null,paths)\n\t\t);\n\t}\n}\n\n\n// WEBPACK FOOTER //\n// ./src/defaults/DefaultLinkWidget.js","import * as React from \"react\";\nimport * as _ from \"lodash\";\nconst div = React.DOM.div;\nimport {DefaultPortLabel} from \"./DefaultPortLabelWidget\";\n\nexport class DefaultNodeWidget extends React.Component {\n\tstatic defaultProps = {\n\t\tnode: null,\n\t};\n\n\tonRemove() {\n\t  this.props.node.remove();\n\t  this.props.diagramEngine.forceUpdate();\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\tdiv({className: 'basic-node', key: 'basic-node', style: {background: this.props.node.color }},\n\t\t\t\tdiv({className:'title', key: 'title'},\n\t\t\t\t\tdiv({className:'name', key: 'name'},this.props.node.name),\n\t\t\t\t\tdiv({className: 'fa fa-close', key: 'close', onClick: this.onRemove.bind(this)})\n\t\t\t\t),\n\t\t\t\tdiv({className:'ports', key: 'ports'},\n\t\t\t\t\tdiv({className: 'in', key: 'in'}, _.map(this.props.node.getInPorts(),(port, i) => {\n\t\t\t\t\t\treturn React.createElement(DefaultPortLabel,{model: port, key: `in-port-${i}`});\n\t\t\t\t\t})),\n\t\t\t\t\tdiv({className: 'out', key: 'out'}, _.map(this.props.node.getOutPorts(),(port, i) => {\n\t\t\t\t\t\treturn React.createElement(DefaultPortLabel,{model: port, key: `out-port-${i}`});\n\t\t\t\t\t}))\n\t\t\t\t)\n\t\t\t)\n\t\t);\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/defaults/DefaultNodeWidget.js","import { LinkModel, NodeModel } from \"./Common\";\nimport { BaseEntity } from \"./BaseEntity\";\nimport * as _ from \"lodash\";\n\nexport class DiagramModel extends BaseEntity {\n\tconstructor(){\n\t\tsuper();\n\n\t\tthis.links = {};\n\t\tthis.nodes = {};\n\n\t\tthis.offsetX = 0;\n\t\tthis.offsetY = 0;\n\t\tthis.zoom = 100;\n\t\tthis.rendered = false;\n\t}\n\n\tdeSerializeDiagram(object, diagramEngine) {\n\t\tthis.deSerialize(object);\n\n\t\tthis.offsetX = object.offsetX;\n\t\tthis.offsetY = object.offsetY;\n\t\tthis.zoom = object.zoom;\n\n\t\t//deserialize nodes\n\t\t_.forEach(object.nodes,(node) => {\n\t\t\tlet nodeOb = diagramEngine.getInstanceFactory(node._class).getInstance();\n\t\t\tnodeOb.deSerialize(node);\n\n\t\t\t//deserialize ports\n\t\t\t_.forEach(node.ports,(port) => {\n\t\t\t\tlet portOb = diagramEngine.getInstanceFactory(port._class).getInstance();\n\t\t\t\tportOb.deSerialize(port);\n\t\t\t\tnodeOb.addPort(portOb);\n\t\t\t});\n\n\t\t\tthis.addNode(nodeOb);\n\t\t});\n\n\t\t_.forEach(object.links,(link) => {\n\t\t\tlet linkOb = diagramEngine.getInstanceFactory(link._class).getInstance();\n\t\t\tlinkOb.deSerialize(link);\n\n\t\t\tif(link.target){\n\t\t\t\tlinkOb.setTargetPort(this.getNode(link.target).getPortFromID(link.targetPort));\n\t\t\t}\n\n\t\t\tif(link.source){\n\t\t\t\tlinkOb.setSourcePort(this.getNode(link.source).getPortFromID(link.sourcePort))\n\t\t\t}\n\n\t\t\tthis.addLink(linkOb);\n\t\t});\n\t}\n\n\tserializeDiagram(){\n\t\treturn _.merge(this.serialize(),{\n\t\t\toffsetX: this.offsetX,\n\t\t\toffsetY: this.offsetY,\n\t\t\tzoom: this.zoom,\n\t\t\tlinks: _.map(this.links,(link) => {\n\t\t\t\treturn link.serialize();\n\t\t\t}),\n\t\t\tnodes: _.map(this.nodes,(link) => {\n\t\t\t\treturn link.serialize();\n\t\t\t}),\n\t\t});\n\t}\n\n\tclearSelection(ignore) {\n\t\t_.forEach(this.getSelectedItems(),(element) => {\n\t\t\tif (ignore && ignore.getID() === element.getID()){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telement.setSelected(false); //TODO dont fire the listener\n\t\t});\n\t}\n\n\tgetSelectedItems() {\n\t\tvar items  = [];\n\n\t\t//find all nodes\n\t\titems = items.concat(_.filter(this.nodes,(node) => {\n\t\t\treturn node.isSelected();\n\t\t}));\n\n\t\t//find all points\n\t\titems = items.concat(_.filter(_.flatMap(this.links,(node) => {\n\t\t\treturn node.points;\n\t\t}),(port) => {\n\t\t\treturn port.isSelected();\n\t\t}));\n\n\t\t//find all links\n\t\treturn items.concat(_.filter(this.links,(link) => {\n\t\t\treturn link.isSelected();\n\t\t}));\n\t}\n\n\tsetZoomLevel(zoom){\n\t\tthis.zoom = zoom;\n\t\tthis.itterateListeners((listener) => {\n\t\t\tlistener.controlsUpdated();\n\t\t});\n\t}\n\n\tsetOffset(offsetX, offsetY) {\n\t\tthis.offsetX = offsetX;\n\t\tthis.offsetY = offsetY;\n\t\tthis.itterateListeners((listener) => {\n\t\t\tlistener.controlsUpdated();\n\t\t});\n\t}\n\n\tsetOffsetX(offsetX) {\n\t\tthis.offsetX = offsetX;\n\t\tthis.itterateListeners((listener) => {\n\t\t\tlistener.controlsUpdated();\n\t\t});\n\t}\n\n\tsetOffsetY(offsetY) {\n\t\tthis.offsetX = offsetY;\n\t\tthis.itterateListeners((listener) => {\n\t\t\tlistener.controlsUpdated();\n\t\t});\n\t}\n\n\tgetOffsetY(){\n\t\treturn this.offsetY;\n\t}\n\n\tgetOffsetX(){\n\t\treturn this.offsetX;\n\t}\n\n\tgetZoomLevel(){\n\t\treturn this.zoom;\n\t}\n\n\tgetNode(node) {\n\t\tif (node instanceof NodeModel){\n\t\t\treturn node;\n\t\t}\n\t\tif (!this.nodes[node]){\n\t\t\treturn null;\n\t\t}\n\t\treturn this.nodes[node];\n\t}\n\n\tgetLink(link) {\n\t\tif (link instanceof LinkModel){\n\t\t\treturn link;\n\t\t}\n\t\tif(!this.links[link]){\n\t\t\treturn null;\n\t\t}\n\t\treturn this.links[link];\n\t}\n\n\taddLink(link) {\n\t\tlink.addListener({\n\t\t\tentityRemoved: () => {\n\t\t\t\tthis.removeLink(link);\n\t\t\t}\n\t\t});\n\t\tthis.links[link.getID()] = link;\n\t\tthis.itterateListeners((listener) => {\n\t\t\tlistener.linksUpdated();\n\t\t});\n\t\treturn link;\n\t}\n\n\taddNode(node) {\n\t\tnode.addListener({\n\t\t\tentityRemoved: () => {\n\t\t\t\tthis.removeNode(node);\n\t\t\t}\n\t\t});\n\t\tthis.nodes[node.getID()] = node;\n\t\tthis.itterateListeners((listener) => {\n\t\t\tlistener.nodesUpdated();\n\t\t});\n\t\treturn node;\n\t}\n\n\tremoveLink(link) {\n\t\tif (link instanceof LinkModel){\n\t\t\tdelete this.links[link.getID()];\n\t\t\tthis.itterateListeners((listener) => {\n\t\t\t\tlistener.linksUpdated();\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tdelete this.links[''+link];\n\t\tthis.itterateListeners((listener) => {\n\t\t\tlistener.linksUpdated();\n\t\t});\n\t}\n\tremoveNode(node) {\n\t\tif (node instanceof NodeModel){\n\t\t\tdelete this.nodes[node.getID()];\n\t\t\tthis.itterateListeners((listener) => {\n\t\t\t\tlistener.nodesUpdated();\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tdelete this.nodes['' + node];\n\t\tthis.itterateListeners((listener) => {\n\t\t\tlistener.nodesUpdated();\n\t\t});\n\t}\n\n\tgetLinks() {\n\t\treturn this.links;\n\t}\n\n\tgetNodes() {\n\t\treturn this.nodes;\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/DiagramModel.js","/**\n * @author Dylan Vorster\n */\nexport class Toolkit {\n\t/**\n   * Generats a unique ID (thanks Stack overflow :3)\n   * @returns {String}\n   */\n\tstatic UID() {\n\t\treturn 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n\t\t\tvar r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n\t\t\treturn v.toString(16);\n\t\t});\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Toolkit.js","import * as React from \"react\";\nimport {PortWidget} from \"../widgets/PortWidget\";\n\n/**\n * @author Dylan Vorster\n */\nexport class DefaultPortLabel extends React.Component {\n\n\tstatic defaultProps = {\n\t\tin: true,\n\t\tlabel: \"port\"\n\t};\n\n\trender() {\n\n\t\tvar port = React.createElement(PortWidget, {name: this.props.model.name, node: this.props.model.getParent()});\n\t\tvar label = React.DOM.div({className: 'name'}, this.props.model.label);\n\n\t\treturn React.DOM.div({className: (this.props.model.in?'in':'out')+'-port'},\n\t\t\tthis.props.model.in?port:label,\n\t\t\tthis.props.model.in?label:port\n\t\t);\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/defaults/DefaultPortLabelWidget.js","import * as React from \"react\";\nimport {LinkWidget} from \"./LinkWidget\";\nimport * as _ from \"lodash\";\n\nexport class LinkLayerWidget extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {};\n\t}\n\t\n\trender() {\n\t\tvar diagramModel = this.props.diagramEngine.getDiagramModel();\n\t\t\n\t\treturn (\n\t\t\tReact.DOM.svg(\n\t\t\t\t{\n          style:{\n\t\t\t\t\ttransform: 'scale(' + diagramModel.getZoomLevel() / 100.0 + ') translate(' + diagramModel.getOffsetX() + 'px,' + diagramModel.getOffsetY()+'px)',\n            width: '100%',\n            height: '100%'\n          }\n        },\n\t\t\t\t_.map(diagramModel.getLinks(),(link) => {\n\t\t\t\t\t\n\t\t\t\t\t//TODO just improve this vastly x_x\n\t\t\t\t\tif (link.sourcePort !== null){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\t//generate a point\n\t\t\t\t\t\t\tlink.points[0].updateLocation(this.props.diagramEngine.getPortCenter(link.sourcePort));\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//remove the link because its problematic (TODO implement this rather at an engine level)\n\t\t\t\t\t\tcatch(ex){\n\t\t\t\t\t\t\tconsole.log(ex);\n\t\t\t\t\t\t\tdiagramModel.removeLink(link);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (link.targetPort !== null){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\t_.last(link.points).updateLocation(this.props.diagramEngine.getPortCenter(link.targetPort));\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//remove the link because its problematic (TODO implement this rather at an engine level)\n\t\t\t\t\t\tcatch(ex){\n\t\t\t\t\t\t\tconsole.log(ex);\n\t\t\t\t\t\t\tdiagramModel.removeLink(link);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n                    \n\t\t\t\t\t//generate links\n\t\t\t\t\tvar generatedLink = this.props.diagramEngine.generateWidgetForLink(link);\n                    if(!generatedLink){\n\t\t\t\t\t\tconsole.log(\"no link generated for type: \" + link.getType());\n\t\t\t\t\t\treturn null;\n                    }\n\t\t\t\t\t\n\t\t\t\t\treturn (\n\t\t\t\t\t\tReact.createElement(LinkWidget, {\n\t\t\t\t\t\t\tkey: link.getID(), \n\t\t\t\t\t\t\tlink: link,\n\t\t\t\t\t\t\tdiagramEngine: this.props.diagramEngine,\n\t\t\t\t\t\t}, React.cloneElement(generatedLink,{pointAdded: this.props.pointAdded}))\n\t\t\t\t\t);\n\t\t\t\t})\n\t\t\t)\n\t\t);\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/widgets/LinkLayerWidget.js","import * as React from \"react\";\n\nexport class LinkWidget extends React.Component {\n\tshouldComponentUpdate(){\n\t\treturn this.props.diagramEngine.canEntityRepaint(this.props.link);\n\t}\n\n\trender() {\n\t\treturn this.props.children;\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/widgets/LinkWidget.js","import * as React from \"react\";\nimport * as _ from \"lodash\";\nimport { NodeWidget } from \"./NodeWidget\";\n\nexport class NodeLayerWidget extends React.Component {\n\trender() {\n\t  const { diagramEngine, updateDiagram } = this.props;\n\t\tconst diagramModel = diagramEngine.getDiagramModel();\n\n\t\treturn (\n\t\t\tReact.DOM.div({\n\t\t\t\t\tclassName:'node-view',\n\t\t\t\t\tkey: 'node-view',\n\t\t\t\t\tstyle:{\n\t\t\t\t\t\ttransform: 'scale(' + diagramModel.getZoomLevel() / 100.0 + ') translate(' + diagramModel.getOffsetX()+'px,'+diagramModel.getOffsetY()+'px)',\n\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\theight: '100%'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_.map(diagramModel.getNodes(),(node) => {\n\t\t\t\t\treturn(\n\t\t\t\t\t\tReact.createElement(NodeWidget, {diagramEngine, updateDiagram, key: node.id, node},\n\t\t\t\t\t\t\tthis.props.diagramEngine.generateWidgetForNode(node))\n\t\t\t\t\t);\n\t\t\t\t})\n\t\t\t)\n\t\t);\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/widgets/NodeLayerWidget.js","import * as React from \"react\";\n\nexport class NodeWidget extends React.Component {\n\tshouldComponentUpdate(){\n\t\treturn this.props.diagramEngine.canEntityRepaint(this.props.node);\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\tReact.DOM.div({\n\t\t\t\t'data-nodeid': this.props.node.id,\n\t\t\t\tclassName: 'node' + (this.props.node.isSelected() ? ' selected' : ''),\n\t\t\t\tstyle:{\n\t\t\t\t\ttop: this.props.node.y,\n\t\t\t\t\tleft: this.props.node.x,\n\t\t\t\t}},\n\t\t\t\tReact.cloneElement(this.props.children, {})\n\t\t\t)\n\t\t);\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/widgets/NodeWidget.js","import * as React from \"react\";\n\nexport class PortWidget extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tselected: false\n\t\t};\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\tReact.DOM.div({\n\t\t\t\tonMouseEnter: () =>{\n\t\t\t\t\tthis.setState({selected: true});\n\t\t\t\t},\n\t\t\t\tonMouseLeave: () => {\n\t\t\t\t\tthis.setState({selected: false});\n\t\t\t\t},\n\t\t\t\tclassName:'port'+(this.state.selected?' selected':''),\n\t\t\t\t'data-name':this.props.name,\n\t\t\t\t'data-nodeid': this.props.node.getID()\n\t\t\t})\n\t\t);\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/widgets/PortWidget.js","import { NodeModel, PointModel } from \"./Common\";\nimport { BaseEntity } from \"./BaseEntity\";\nimport { DiagramModel } from \"./DiagramModel\";\nimport * as _ from \"lodash\";\n\n/**\n * Passed as a parameter to the DiagramWidget\n */\nexport class DiagramEngine extends BaseEntity {\n\tconstructor(){\n\t\tsuper();\n\t\tthis.diagramModel = new DiagramModel();\n\t\tthis.nodeFactories = {};\n\t\tthis.linkFactories = {};\n\t\tthis.instanceFactories = {};\n\t\tthis.canvas = null;\n\t\tthis.paintableWidgets = null;\n\t\tthis.forceUpdate = () => {};\n\t}\n\n\tclearRepaintEntities(){\n\t\tthis.paintableWidgets = null;\n\t}\n\n\tenableRepaintEntities(entities) {\n\t\tthis.paintableWidgets = {};\n\t\tentities.forEach((entity) => {\n\n\t\t\t//if a node is requested to repaint, add all of its links\n\t\t\tif (entity instanceof NodeModel){\n\t\t\t\t_.forEach(entity.getPorts(),(port) => {\n\t\t\t\t\t_.forEach(port.getLinks(),(link) => {\n\t\t\t\t\t\tthis.paintableWidgets[link.getID()] = true;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (entity instanceof PointModel){\n\t\t\t\tthis.paintableWidgets[entity.getLink().getID()] = true;\n\t\t\t}\n\n\t\t\tthis.paintableWidgets[entity.getID()] = true;\n\t\t});\n\t}\n\n\tcanEntityRepaint(baseModel) {\n\t\t//no rules applied, allow repaint\n\t\tif(this.paintableWidgets === null){\n\t\t\treturn true;\n\t\t}\n\n\t\treturn this.paintableWidgets[baseModel.getID()] !== undefined;\n\t}\n\n\tsetCanvas(canvas) {\n\t\tthis.canvas = canvas;\n\t}\n\n\tsetDiagramModel(model) {\n\t\tthis.diagramModel = model;\n\t}\n\n\tsetForceUpdate(forceUpdate) {\n\t  this.forceUpdate = forceUpdate;\n\t}\n\n\tgetDiagramModel() {\n\t\treturn this.diagramModel;\n\t}\n\n\tgetNodeFactories() {\n\t\treturn this.nodeFactories;\n\t}\n\n\tgetLinkFactories() {\n\t\treturn this.linkFactories;\n\t}\n\n\tgetInstanceFactory(className) {\n\t\treturn this.instanceFactories[className];\n\t}\n\n\tregisterInstanceFactory(factory) {\n\t\tthis.instanceFactories[factory.getName()] = factory;\n\t}\n\n\tregisterNodeFactory(factory) {\n\t\tthis.nodeFactories[factory.getType()] = factory;\n\t\tthis.itterateListeners((listener) => {\n\t\t\tlistener.nodeFactoriesUpdated();\n\t\t});\n\t}\n\n\tregisterLinkFactory(factory) {\n\t\tthis.linkFactories[factory.getType()] = factory;\n\t\tthis.itterateListeners((listener) => {\n\t\t\tlistener.linkFactoriesUpdated();\n\t\t});\n\t}\n\n\tgetFactoryForNode(node) {\n\t\tif (this.nodeFactories[node.getType()]){\n\t\t\treturn this.nodeFactories[node.getType()];\n\t\t}\n\t\tconsole.log(\"cannot find widget factory for node of type: [\" + node.getType()+\"]\");\n\t\treturn null;\n\t}\n\n\tgetFactoryForLink(link) {\n\t\tif (this.linkFactories[link.getType()]){\n\t\t\treturn this.linkFactories[link.getType()];\n\t\t}\n\t\tconsole.log(\"cannot find widget factory for link of type: [\" + link.getType()+\"]\");\n\t\treturn null;\n\t}\n\n\tgenerateWidgetForLink(link) {\n\t\tvar linkFactory = this.getFactoryForLink(link);\n\t\tif(!linkFactory){\n\t\t\tthrow \"Cannot find link factory for link: \" + link.getType();\n\t\t}\n\t\treturn linkFactory.generateReactWidget(this, link);\n\t}\n\n\tgenerateWidgetForNode(node) {\n\t\tvar nodeFactory = this.getFactoryForNode(node);\n\t\tif(!nodeFactory){\n\t\t\tthrow \"Cannot find widget factory for node: \" + node.getType();\n\t\t}\n\t\treturn nodeFactory.generateReactWidget(this, node);\n\t}\n\n\tgetRelativeMousePoint(event) {\n\t\tvar point = this.getRelativePoint(event.pageX,event.pageY);\n\t\treturn {\n\t\t\tx: (point.x / (this.diagramModel.getZoomLevel() / 100.0)) - this.diagramModel.getOffsetX(),\n\t\t\ty: (point.y / (this.diagramModel.getZoomLevel() / 100.0)) - this.diagramModel.getOffsetY()\n\t\t};\n\t}\n\n\tgetRelativePoint(x,y){\n\t\tvar canvasRect = this.canvas.getBoundingClientRect();\n\t\treturn {x: x-canvasRect.left,y:y-canvasRect.top};\n\t}\n\n\tgetNodePortElement(port) {\n\t\tvar selector = this.canvas.querySelector('.port[data-name=\"' + port.getName() + '\"][data-nodeid=\"' + port.getParent().getID()+'\"]');\n\t\tif(selector === null){\n\t\t\tthrow \"Cannot find Node Port element with nodeID: [\" + port.getParent().getID()+\"] and name: [\"+port.getName()+\"]\";\n\t\t}\n\t\treturn selector;\n\t}\n\n\tgetPortCenter(port) {\n\t\tvar sourceElement = this.getNodePortElement(port);\n\t\tvar sourceRect = sourceElement.getBoundingClientRect();\n\n\t\tvar rel = this.getRelativePoint(sourceRect.left,sourceRect.top);\n\n\t\treturn {\n\t\t\tx: ((sourceElement.offsetWidth / 2) + rel.x / (this.diagramModel.getZoomLevel() / 100.0)) - this.diagramModel.getOffsetX(),\n\t\t\ty: ((sourceElement.offsetHeight/2)+rel.y/(this.diagramModel.getZoomLevel()/100.0)) - this.diagramModel.getOffsetY()\n\t\t};\n\t}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/DiagramEngine.js","import { LinkModel } from \"./Common\";\nimport {AbstractInstanceFactory} from \"./AbstractInstanceFactory\";\n\nexport class LinkInstanceFactory extends AbstractInstanceFactory {\n\tconstructor(){\n\t\tsuper(\"LinkModel\");\n\t}\n\t\n\tgetInstance(){\n\t\treturn new LinkModel();\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/LinkInstanceFactory.js","import {LinkWidgetFactory} from \"../WidgetFactories\";\nimport * as React from \"react\";\nimport {DefaultLinkWidget} from \"./DefaultLinkWidget\";\n/**\n * @author Dylan Vorster\n */\nexport class DefaultLinkFactory extends LinkWidgetFactory {\n\n\tconstructor(){\n\t\tsuper(\"default\");\n\t}\n\n\tgenerateReactWidget(diagramEngine, link) {\n\t\treturn React.createElement(DefaultLinkWidget, {\n\t\t\tlink,\n\t\t\tdiagramEngine\n\t\t});\n\t}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/defaults/DefaultLinkFactory.js","import {NodeWidgetFactory} from \"../WidgetFactories\";\nimport * as React from \"react\";\nimport {DefaultNodeWidget} from \"./DefaultNodeWidget\";\n/**\n * @author Dylan Vorster\n */\nexport class DefaultNodeFactory extends NodeWidgetFactory{\n\n\tconstructor(){\n\t\tsuper(\"default\");\n\t}\n\n\tgenerateReactWidget(diagramEngine, node) {\n\t\treturn React.createElement(DefaultNodeWidget,{\n\t\t\tnode,\n\t\t\tdiagramEngine\n\t\t});\n\t}\n}\n\n\n// WEBPACK FOOTER //\n// ./src/defaults/DefaultNodeFactory.js","import {NodeModel} from \"../Common\";\nimport * as _ from \"lodash\";\n\nimport {AbstractInstanceFactory} from \"../AbstractInstanceFactory\";\n\nexport class DefaultNodeInstanceFactory extends AbstractInstanceFactory {\n\tconstructor(){\n\t\tsuper('DefaultNodeModel');\n\t}\n\n\tgetInstance(){\n\t\treturn new DefaultNodeModel();\n\t}\n}\n\nexport class DefaultNodeModel extends NodeModel {\n\tconstructor(name = 'Untitled', color = 'rgb(0,192,255)') {\n\t\tsuper('default');\n\t\tthis.name = name;\n\t\tthis.color = color;\n\t}\n\n\tdeSerialize(object) {\n\t\tsuper.deSerialize(object);\n\t\tthis.name = object.name;\n\t\tthis.color = object.color;\n\t}\n\n\tserialize() {\n\t\treturn _.merge(super.serialize(), {\n\t\t\tname: this.name,\n\t\t\tcolor: this.color,\n\t\t});\n\t}\n\n\tgetInPorts() {\n\t\treturn _.filter(this.ports,(portModel) => portModel.in);\n\t}\n\n\tgetOutPorts() {\n\t\treturn _.filter(this.ports,(portModel) => !portModel.in);\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/defaults/DefaultNodeModel.js","import {PortModel} from \"../Common\";\nimport * as _ from \"lodash\";\nimport {AbstractInstanceFactory} from \"../AbstractInstanceFactory\";\n\nexport class DefaultPortInstanceFactory extends AbstractInstanceFactory {\n\tconstructor(){\n\t\tsuper(\"DefaultPortModel\");\n\t}\n\t\n\tgetInstance(){\n\t\treturn new DefaultPortModel(true,\"unknown\");\n\t}\n}\n\n/**\n * @author Dylan Vorster\n */\nexport class DefaultPortModel extends PortModel {\n\tconstructor(isInput ,name, label = null) {\n\t\tsuper(name);\n\t\tthis.in = isInput;\n\t\tthis.label = label || name;\n\t}\n\t\n\tdeSerialize(object){\n\t\tsuper.deSerialize(object);\n\t\tthis.in = object.in;\n\t\tthis.label = object.label;\n\t}\n\t\n\tserialize(){\n\t\treturn _.merge(super.serialize(),{\n\t\t\tin: this.in,\n\t\t\tlabel: this.label,\n\t\t});\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/defaults/DefaultPortModel.js","import * as React from \"react\";\nimport * as _ from \"lodash\";\nimport { PointModel, NodeModel, LinkModel, PortModel } from \"../Common\";\nimport { LinkLayerWidget } from \"./LinkLayerWidget\";\nimport { NodeLayerWidget } from \"./NodeLayerWidget\";\n\nexport class BaseAction {\n\tconstructor(mouseX, mouseY) {\n\t\tthis.mouseX = mouseX;\n\t\tthis.mouseY = mouseY;\n\t\tthis.ms = (new Date()).getTime();\n\t}\n}\n\nclass SelectingAction extends BaseAction {\n\tconstructor(mouseX, mouseY) {\n\t\tsuper(mouseX, mouseY);\n\t\tthis.mouseX2 = mouseX;\n\t\tthis.mouseY2 = mouseY;\n\t}\n\n\tcontainsElement(x, y, diagramModel) {\n\t\tvar z = diagramModel.getZoomLevel()/100.0;\n\t\treturn (\n\t\t\t(x + diagramModel.getOffsetX())*z > this.mouseX\t&&\n\t\t\t(x + diagramModel.getOffsetX())*z < this.mouseX2 &&\n\t\t\t(y + diagramModel.getOffsetY())*z > this.mouseY\t&&\n\t\t\t(y + diagramModel.getOffsetY())*z < this.mouseY2\n\t\t);\n\t}\n}\n\nclass MoveCanvasAction extends BaseAction {\n\tconstructor(mouseX, mouseY, diagramModel) {\n\t\tsuper(mouseX,mouseY);\n\t\tthis.initialOffsetX = diagramModel.getOffsetX();\n\t\tthis.initialOffsetY = diagramModel.getOffsetY();\n\t}\n}\n\nclass MoveItemsAction extends BaseAction {\n\tconstructor(mouseX, mouseY, diagramEngine) {\n\t\tsuper(mouseX, mouseY);\n\t\tthis.moved = false;\n\t\tdiagramEngine.enableRepaintEntities(diagramEngine.getDiagramModel().getSelectedItems());\n\t\tthis.selectionModels = diagramEngine.getDiagramModel().getSelectedItems().map(item => {\n\t\t\treturn {\n\t\t\t\tmodel: item,\n\t\t\t\tinitialX: item.x,\n\t\t\t\tinitialY: item.y,\n\t\t\t};\n\t\t});\n\t}\n}\n\nexport class DiagramWidget extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\taction: null,\n\t\t\trenderedNodes: false,\n\t\t\twindowListener: null\n\t\t};\n\t}\n\n\tcomponentWillUnmount(){\n\t\tthis.props.diagramEngine.setCanvas(null);\n\t\twindow.removeEventListener('keydown', this.state.windowListener);\n\t}\n\n\tcomponentWillUpdate(nextProps) {\n\t\tif (this.props.diagramEngine.diagramModel.id !== nextProps.diagramEngine.diagramModel.id) {\n\t\t\tthis.setState({ renderedNodes: false });\n\t\t\tnextProps.diagramEngine.diagramModel.rendered = true;\n\t\t}\n\t\tif (!nextProps.diagramEngine.diagramModel.rendered) {\n\t\t\tthis.setState({ renderedNodes: false });\n\t\t\tnextProps.diagramEngine.diagramModel.rendered = true;\n\t\t}\n\t}\n\n\tcomponentDidUpdate() {\n\t\tif (!this.state.renderedNodes) {\n\t\t\tthis.setState({\n\t\t\t\trenderedNodes: true\n\t\t\t});\n\t\t}\n\t}\n\n\tcomponentDidMount(){\n\t\tthis.props.diagramEngine.setCanvas(this.refs['canvas']);\n\t\tthis.props.diagramEngine.setForceUpdate(this.forceUpdate.bind(this));\n\n\t\t//add a keyboard listener\n\t\tthis.setState({\n\t\t\trenderedNodes: true,\n\t\t\twindowListener: window.addEventListener('keydown', (event) => {\n\n\t\t\t\t//delete all selected\n\t\t\t\tif(event.keyCode === 46 || event.keyCode === 8){\n\t\t\t\t\t_.forEach(this.props.diagramEngine.getDiagramModel().getSelectedItems(),(element) => {\n\t\t\t\t\t\telement.remove();\n\t\t\t\t\t});\n\t\t\t\t\tthis.forceUpdate();\n\t\t\t\t}\n\t\t\t})\n\t\t});\n\t\twindow.focus();\n\t}\n\n\t/**\n\t * Gets a model and element under the mouse cursor\n\t */\n\tgetMouseElement(event) {\n\t\tvar target = event.target;\n\t\tvar diagramModel = this.props.diagramEngine.diagramModel;\n\n\t\t//is it a port\n\t\tvar element = target.closest('.port[data-name]');\n\t\tif(element){\n\t\t\tvar nodeElement = target.closest('.node[data-nodeid]');\n\t\t\treturn {\n\t\t\t\tmodel: diagramModel.getNode(nodeElement.getAttribute('data-nodeid')).getPort(element.getAttribute('data-name')),\n\t\t\t\telement: element\n\t\t\t};\n\t\t}\n\n\t\t//look for a point\n\t\telement = target.closest('.point[data-id]');\n\t\tif(element){\n\t\t\treturn {\n\t\t\t\tmodel: diagramModel.getLink(element.getAttribute('data-linkid')).getPointModel(element.getAttribute('data-id')),\n\t\t\t\telement: element\n\t\t\t};\n\t\t}\n\n\t\t//look for a link\n\t\telement = target.closest('[data-linkid]');\n\t\tif(element){\n\t\t\treturn {\n\t\t\t\tmodel: diagramModel.getLink(element.getAttribute('data-linkid')),\n\t\t\t\telement: element\n\t\t\t};\n\t\t}\n\n\t\t//look for a node\n\t\telement = target.closest('.node[data-nodeid]');\n\t\tif(element){\n\t\t\treturn {\n\t\t\t\tmodel: diagramModel.getNode(element.getAttribute('data-nodeid')),\n\t\t\t\telement: element\n\t\t\t};\n\t\t}\n\n\t\treturn null;\n\t}\n\n\trender() {\n\t\tvar diagramEngine = this.props.diagramEngine;\n\t\tvar diagramModel = diagramEngine.getDiagramModel();\n\n\t\treturn (\n\t\t\tReact.DOM.div({\n\t\t\t\t\tref:'canvas',\n\t\t\t\t\tclassName:'react-js-diagrams-canvas',\n\t\t\t\t\tonWheel: (event) => {\n                        event.preventDefault();\n                        event.stopPropagation();\n\t\t\t\t\t\tdiagramModel.setZoomLevel(diagramModel.getZoomLevel()+(event.deltaY/60));\n\t\t\t\t\t\tdiagramEngine.enableRepaintEntities([]);\n\t\t\t\t\t\tthis.forceUpdate();\n\t\t\t\t\t},\n\t\t\t\t\tonMouseMove: (event) => {\n\n\n\t\t\t\t\t\t//select items so draw a bounding box\n\t\t\t\t\t\tif (this.state.action instanceof SelectingAction){\n\t\t\t\t\t\t\tvar relative = diagramEngine.getRelativePoint(event.pageX, event.pageY);\n\n\t\t\t\t\t\t\t_.forEach(diagramModel.getNodes(), (node) => {\n\t\t\t\t\t\t\t\tif ((this.state.action).containsElement(node.x, node.y, diagramModel)){\n\t\t\t\t\t\t\t\t\tnode.setSelected(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t_.forEach(diagramModel.getLinks(),(link) => {\n\t\t\t\t\t\t\t\tvar allSelected = true;\n\t\t\t\t\t\t\t\t_.forEach(link.points,(point) => {\n\t\t\t\t\t\t\t\t\tif ((this.state.action).containsElement(point.x, point.y, diagramModel)){\n\t\t\t\t\t\t\t\t\t\tpoint.setSelected(true);\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\tallSelected = false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tif (allSelected){\n\t\t\t\t\t\t\t\t\tlink.setSelected(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.state.action.mouseX2 = relative.x;\n\t\t\t\t\t\t\tthis.state.action.mouseY2 = relative.y;\n\t\t\t\t\t\t\tthis.setState({action: this.state.action});\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//translate the items on the canvas\n\t\t\t\t\t\telse if (this.state.action instanceof MoveItemsAction){\n\t\t\t\t\t\t\t_.forEach(this.state.action.selectionModels,(model) => {\n\t\t\t\t\t\t\t\tif (model.model instanceof NodeModel || model.model instanceof PointModel){\n\t\t\t\t\t\t\t\t\tmodel.model.x = model.initialX + ((event.pageX - this.state.action.mouseX) / (diagramModel.getZoomLevel()/100));\n\t\t\t\t\t\t\t\t\tmodel.model.y = model.initialY + ((event.pageY - this.state.action.mouseY) / (diagramModel.getZoomLevel()/100));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tthis.forceUpdate();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//translate the actual canvas\n\t\t\t\t\t\telse if (this.state.action instanceof MoveCanvasAction){\n\t\t\t\t\t\t\tdiagramModel.setOffset(\n\t\t\t\t\t\t\t\tthis.state.action.initialOffsetX + ((event.pageX - this.state.action.mouseX) / (diagramModel.getZoomLevel()/100)),\n\t\t\t\t\t\t\t\tthis.state.action.initialOffsetY+((event.pageY-this.state.action.mouseY)/(diagramModel.getZoomLevel()/100))\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.forceUpdate();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonMouseDown: (event) => {\n\t\t\t\t\t\tdiagramEngine.clearRepaintEntities();\n\n\t\t\t\t\t\tvar model = this.getMouseElement(event);\n\t\t\t\t\t\t//its the canvas\n\t\t\t\t\t\tif(model === null){\n\t\t\t\t\t\t\t//is it a multiple selection\n\t\t\t\t\t\t\tif (event.shiftKey){\n\t\t\t\t\t\t\t\tvar relative = diagramEngine.getRelativePoint(event.pageX, event.pageY);\n\t\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\t\taction: new SelectingAction(\n\t\t\t\t\t\t\t\t\t\trelative.x, relative.y\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t//its a drag the canvas event\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\trelative = diagramEngine.getRelativePoint(event.pageX, event.pageY);\n\t\t\t\t\t\t\t\tdiagramModel.clearSelection();\n\t\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\t\taction: new MoveCanvasAction(relative.x, relative.y, diagramModel)\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//its a port element, we want to drag a link\n\t\t\t\t\t\telse if (model.model instanceof PortModel){\n\t\t\t\t\t\t\trelative = diagramEngine.getRelativeMousePoint(event);\n\t\t\t\t\t\t\tvar link = new LinkModel();\n\t\t\t\t\t\t\tlink.setSourcePort(model.model);\n\n\t\t\t\t\t\t\tlink.getFirstPoint().updateLocation(relative);\n\t\t\t\t\t\t\tlink.getLastPoint().updateLocation(relative);\n\n\t\t\t\t\t\t\tdiagramModel.clearSelection();\n\t\t\t\t\t\t\tlink.getLastPoint().setSelected(true);\n\t\t\t\t\t\t\tdiagramModel.addLink(link);\n\n\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\taction: new MoveItemsAction(event.pageX, event.pageY, diagramEngine)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//its some or other element, probably want to move it\n\t\t\t\t\t\telse{\n\n\t\t\t\t\t\t\tif (!event.shiftKey && !model.model.isSelected()){\n\t\t\t\t\t\t\t\tdiagramModel.clearSelection();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tmodel.model.setSelected(true);\n\n\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\taction: new MoveItemsAction(event.pageX, event.pageY,diagramEngine)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonMouseUp: (event) => {\n\t\t\t\t\t\t//are we going to connect a link to something?\n\t\t\t\t\t\tif (this.state.action instanceof MoveItemsAction){\n\t\t\t\t\t\t\tvar element = this.getMouseElement(event);\n\t\t\t\t\t\t\tif(element){\n\t\t\t\t\t\t\t\t_.forEach(this.state.action.selectionModels,(model) => {\n\n\t\t\t\t\t\t\t\t\t//only care about points connecting to things\n\t\t\t\t\t\t\t\t\tif (!(model.model instanceof PointModel)){\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (element.model instanceof PortModel){\n\t\t\t\t\t\t\t\t\t\tmodel.model.getLink().setTargetPort(element.model);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdiagramEngine.clearRepaintEntities();\n\t\t\t\t\t\tthis.setState({ action: null });\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tthis.state.renderedNodes ?\n\t\t\t\t\tReact.createElement(LinkLayerWidget, {\n\t\t\t\t\t  key: 'diagram-engine',\n\t\t\t\t\t\tdiagramEngine: diagramEngine, pointAdded: (point, event) => {\n\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t\tdiagramModel.clearSelection(point);\n\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\taction: new MoveItemsAction(event.pageX, event.pageY, diagramEngine)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}) : null,\n\t\t\t\t\tReact.createElement(NodeLayerWidget, { diagramEngine, updateDiagram: this.forceUpdate }),\n\t\t\t\t\tthis.state.action instanceof SelectingAction ?\n\t\t\t\t\t\tReact.DOM.div({\n\t\t\t\t\t\t\tclassName: 'selector',\n\t\t\t\t\t\t\tkey: 'selector',\n\t\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\t\ttop: this.state.action.mouseY,\n\t\t\t\t\t\t\t\tleft: this.state.action.mouseX,\n\t\t\t\t\t\t\t\twidth: this.state.action.mouseX2 - this.state.action.mouseX,\n\t\t\t\t\t\t\t\theight: this.state.action.mouseY2 - this.state.action.mouseY,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}) : null\n\t\t\t)\n\t\t);\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/widgets/DiagramWidget.js","/**\n * @author Dylan Vorster\n */\n\n //export defaults\nexport * from './defaults/DefaultLinkFactory';\nexport * from './defaults/DefaultLinkWidget';\nexport * from './defaults/DefaultNodeFactory';\nexport * from './defaults/DefaultNodeWidget';\nexport * from './defaults/DefaultNodeModel';\nexport * from './defaults/DefaultPortModel';\nexport * from './defaults/DefaultPortLabelWidget';\n\nexport * from './WidgetFactories';\nexport * from './Toolkit';\n\nexport * from './DiagramEngine';\nexport * from './DiagramModel';\nexport * from './BaseEntity';\nexport * from './Common';\nexport * from './AbstractInstanceFactory';\nexport * from './LinkInstanceFactory';\n\nexport * from './widgets/DiagramWidget';\nexport * from './widgets/LinkLayerWidget';\nexport * from './widgets/LinkWidget';\nexport * from './widgets/NodeLayerWidget';\nexport * from './widgets/NodeWidget';\nexport * from './widgets/PortWidget';\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}